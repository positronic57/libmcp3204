<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>MCP3204 library: libmcp3204</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">MCP3204 library
   &#160;<span id="projectnumber">v0.1</span>
   </div>
   <div id="projectbrief">Libmcp3204 is a user space C library for communication with Microchip MCP3204 12-bit 4 channel ADC over SPI interface on Linux systems.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">libmcp3204 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Goce Boshkovski</dd></dl>
<h1><a class="anchor" id="desc"></a>
Short Description</h1>
<p>Libmcp3204 is a user space C library for communication with Microchip MCP3204 12-bit 4 channel ADC over SPI interface on Linux systems. It provides access to MCP3204 ADC using the SPI kernel module present on the system (spi_bcm2708 in case of Rasperry Pi with Raspbian). The low level SPI communication (data and control signals) is done by the kernel module, while the library implements the data exchange protocol supported by the MCP3204 ADC.</p>
<p>Ioctl() and SPI_IOC_MESSAGE(N) requests are used to achieve a full-duplex synchronous communication with the ADC. It supports single ended and differential input channel modes of MCP3204. The SPI communication can be done either by SPI mode 0,0 or SPI mode 1,1.</p>
<h1><a class="anchor" id="hwsupp"></a>
Supported Hardware</h1>
<p>The library has been developed and tested on Raspberry Pi. Should work on any other Linux system with SPI hardware and apropriate kernel module.</p>
<h1><a class="anchor" id="use"></a>
Usage</h1>
<p>The initialization of the on-board SPI and MCP3204 is done via <a class="el" href="group__libFunctions.html#gad2edfba80749ed842e051333f921f540" title="The function configures the SPI interface of Raspberry Pi according to MCP3204 SPI properties...">MCP3204_init()</a> function. For example, if MPC3204 is connected to SPI device /dev/spidev0.1, with reference voltage 2.491V and SPI mode is 0,0 the init function is: </p><pre class="fragment">int fd;
MCP3204 ADC;
char error[20];

MCP3204_init(&amp;fd,"/dev/spidev0.1",&amp;ADC,mode_SPI_00,2.491,error);
</pre><p>where:</p><ul>
<li>fd is a file descriptor required for accessing the SPI device file;</li>
<li>ADC is the structure that represents MCP3204;</li>
<li>mode_SPI_00 defines the SPI mode as 0,0;</li>
<li>error points to the error message string generated in case of a failure.</li>
</ul>
<p>The init function sets the SPI clock frequency by default to 100KHz. The current version of the library doesn't support change of this parameter.</p>
<p>After the init process is successfully finished, <a class="el" href="group__libFunctions.html#ga51e7d913ee79bf57a901ea3ed3141a8b" title="Starts the AD conversion process and read the digital value of the analog signal from MCP3204...">MCP3204_convert()</a> function starts the AD conversion of the selected analog input channel that can be configured as single-ended or pseudo-differential pair. If the analog input is connected to channel 0, then the AD conversion is started with: </p><pre class="fragment">MCP3204_convert(fd,singleEnded,CH0,&amp;ADC,error);
</pre><p>where:</p><ul>
<li>fd is the same file descriptor as the one from <a class="el" href="group__libFunctions.html#gad2edfba80749ed842e051333f921f540" title="The function configures the SPI interface of Raspberry Pi according to MCP3204 SPI properties...">MCP3204_init()</a> function;</li>
<li>ADC is the structure that represents MCP3204;</li>
<li>error points to the error message string generated in case of a failure.</li>
</ul>
<p>The digital value that is a result of the conversation and the original analog value are available via <a class="el" href="group__libFunctions.html#gabaa15931f5a0b9097e5ce0ebf6849b11" title="The function returns the result from the AD conversion. ">MCP3204_getValue()</a> and <a class="el" href="group__libFunctions.html#ga16417ceedf56a401cfe5931b2ec3581e" title="The function calculates the value of the analog input. ">MCP3204_analogValue()</a> functions accordingly: </p><pre class="fragment">MCP3204_getValue(ADC); //returns the result of the ADC
MCP3204_analogValue(ADC); //returns the analog value of the input
</pre><p>Check the doc folder for detailed description of the library.</p>
<p>The library source code is distributed with example program that demonstrates the usage of the libmcp3024 for temperature measurement with TMP36 analog temperature sensor.</p>
<dl class="section warning"><dt>Warning</dt><dd>The source is provided as it is without any warranty. Use it on your own risk! The author does not take any responsibility for the damage caused while using this software. </dd></dl>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Nov 29 2015 21:01:22 for MCP3204 library by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
